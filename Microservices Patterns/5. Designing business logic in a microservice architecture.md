# Designing business logic in a microservice architecture

![img_116.png](img_116.png)

![img_117.png](img_117.png)

## Transaction script pattern for simple business logic

![img_118.png](img_118.png)

## Designing business logic using the Domain model pattern

Organize the business logic as an object model consisting of classes that have state
and behavior.

In an object-oriented design, the business logic consists of an object model, a network
of relatively small classes. These classes typically correspond directly to concepts from
the problem domain. In such a design some classes have only either state or behavior,
but many contain both, which is the hallmark of a well-designed class.

![img_119.png](img_119.png)

![img_120.png](img_120.png)

## Using DDD

![img_121.png](img_121.png)

### Designing a domain model using the DDD aggregate pattern

Organize a domain model as a collection of aggregates, each of which is a graph of
objects that can be treated as a unit.

An Order aggregate consists of
an Order entity, one or more OrderLineItem value objects, and other value objects
such as a delivery Address and PaymentInformation.

![img_122.png](img_122.png)

![img_123.png](img_123.png)

![img_124.png](img_124.png)

#### Aggregates must obey certain rules. 

-- RULE #1: REFERENCE ONLY THE AGGREGATE ROOT

![img_125.png](img_125.png)

-- RULE #2: INTER-AGGREGATE REFERENCES MUST USE PRIMARY KEYS

![img_126.png](img_126.png)

-- RULE #3: ONE TRANSACTION CREATES OR UPDATES ONE AGGREGATE

![img_127.png](img_127.png)





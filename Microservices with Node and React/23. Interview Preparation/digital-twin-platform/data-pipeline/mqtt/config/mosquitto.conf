# Mosquitto MQTT Broker Configuration for Digital Twin Platform

# =============================================================================
# General Configuration
# =============================================================================
port 1883
bind_address 0.0.0.0

# WebSocket support for browser clients
listener 9001
protocol websockets

# =============================================================================
# Security Configuration
# =============================================================================
allow_anonymous true
# In production, set to false and configure authentication

# =============================================================================
# Persistence Configuration
# =============================================================================
persistence true
persistence_location /mosquitto/data/
autosave_interval 300
autosave_on_changes false

# =============================================================================
# Logging Configuration
# =============================================================================
log_dest file /mosquitto/log/mosquitto.log
log_dest stdout
log_type error
log_type warning
log_type notice
log_type information
log_type debug
log_timestamp true
log_timestamp_format %Y-%m-%d %H:%M:%S

# =============================================================================
# Connection Configuration
# =============================================================================
max_connections 1000
max_inflight_messages 20
max_queued_messages 1000
message_size_limit 8192

# =============================================================================
# Client Configuration
# =============================================================================
client_id_prefixes digital_twin_
max_keepalive 65535
keepalive_interval 60

# =============================================================================
# Topic Configuration for Digital Twin
# =============================================================================
# Topic structure: manufacturing/{machine_id}/{sensor_type}
# Example: manufacturing/CNC-001/temperature

# QoS levels:
# 0 - At most once (fire and forget)
# 1 - At least once (acknowledged delivery)
# 2 - Exactly once (assured delivery)

# =============================================================================
# Bridge Configuration (for future multi-site deployments)
# =============================================================================
# connection bridge-01
# address remote-broker:1883
# topic manufacturing/# out 0
# topic manufacturing/# in 0

# =============================================================================
# Plugin Configuration
# =============================================================================
# auth_plugin /mosquitto/auth-plugin.so
# auth_opt_backends sqlite
# auth_opt_sqlite_userquery SELECT password FROM users WHERE username = $1

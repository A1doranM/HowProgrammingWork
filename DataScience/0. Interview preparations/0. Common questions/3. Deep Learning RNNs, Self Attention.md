# –ß—Ç–æ —Ç–∞–∫–æ–µ RNN?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —á–∏—Ç–∞–µ—Ç–µ –∫–Ω–∏–≥—É. –í—ã –Ω–µ –∑–∞–±—ã–≤–∞–µ—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–ª–æ–≤–∞ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∏—Ö –ø—Ä–æ—á—Ç–µ–Ω–∏—è - –≤—ã –¥–µ—Ä–∂–∏—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ –≥–æ–ª–æ–≤–µ. RNN —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ö–æ–∂–∏–º –æ–±—Ä–∞–∑–æ–º: –æ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç __—Å–ª–æ–≤–æ –∑–∞ —Å–ª–æ–≤–æ–º__ –∏ __–∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç__.

–û–±—ã—á–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å –≤–∏–¥–∏—Ç –≤—Å–µ —Å–ª–æ–≤–∞ —Å—Ä–∞–∑—É –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ. RNN –≤–∏–¥–∏—Ç —Å–ª–æ–≤–∞ __–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ__ –∏ __–ø–æ–º–Ω–∏—Ç__, —á—Ç–æ –±—ã–ª–æ —Ä–∞–Ω—å—à–µ.

__–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:__ –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ RNN –±–µ—Ä–µ—Ç:

1. __–¢–µ–∫—É—â–µ–µ —Å–ª–æ–≤–æ__ ($x_t$)

2. __–ü–∞–º—è—Ç—å –æ –ø—Ä–æ—à–ª–æ–º__ ($h_{t-1}$)
 (—Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å –ø—Ä–æ—à–ª–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞)
3. –ò —Å–æ–∑–¥–∞–µ—Ç __–Ω–æ–≤—É—é –ø–∞–º—è—Ç—å__ ($h_t$)
, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–±–æ –í–°–Å–ú, —á—Ç–æ –±—ã–ª–æ –¥–æ —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ (–Ω–æ–≤–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)

–°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - –ø–æ —Å—É—Ç–∏ —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–µ–≥–æ –µ–º–±–µ–¥–∏–Ω–≥–∞ (—Å–ª–æ–≤–∞) —Å —É—á–µ—Ç–æ–º —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ—Ç–æ—Ä–æ–µ –ø–µ—Ä–µ–¥–∞–ª–æ—Å—å –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ (—Ç–æ–µ—Å—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–ª–æ–≤–∞). –õ–∏–±–æ –µ—â–µ –ø—Ä–æ—â–µ, —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —ç—Ç–æ–≥–æ —Å–ª–æ–≤–∞ —Å —É—á–µ—Ç–æ–º —Å–ª–æ–≤ –¥–æ –Ω–µ–≥–æ. –°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥—è—â–µ–≥–æ —Å–ª–æ–≤–∞ –æ–±—ã—á–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç –ª–∏–±–æ –Ω—É–ª—è–º–∏, –ª–∏–±–æ —Å–ª—É—á–∞–π–Ω–æ.  

### –§–æ—Ä–º—É–ª–∞ 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–ø–∞–º—è—Ç–∏)

$$h_t = \tanh(W_{hh} \cdot h_{t-1} + W_{xh} \cdot x_t + b_h)$$

–ì–¥–µ: 

$$h_t = \tanh(\underbrace{W_{hh} \cdot h_{t-1}}_{\text{–≤—Å–µ —Å—Ç–∞—Ä—ã–µ —Å–ª–æ–≤–∞}} + \underbrace{W_{xh} \cdot x_t}_{\text{–Ω–æ–≤–æ–µ —Å–ª–æ–≤–æ}} + b_h)$$

```
–ù–æ–≤–∞—è –ø–∞–º—è—Ç—å = tanh(
    "–∫–∞–∫ —É—á–µ—Å—Ç—å —Å—Ç–∞—Ä—É—é –ø–∞–º—è—Ç—å" √ó —Å—Ç–∞—Ä–∞—è_–ø–∞–º—è—Ç—å +
    "–∫–∞–∫ —É—á–µ—Å—Ç—å –Ω–æ–≤–æ–µ —Å–ª–æ–≤–æ" √ó –Ω–æ–≤–æ–µ_—Å–ª–æ–≤–æ +
    —Å–º–µ—â–µ–Ω–∏–µ
)
```

## –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. __–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞__: RNN –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–æ–≤–∞ –ø–æ –æ—á–µ—Ä–µ–¥–∏, –∞ –Ω–µ –≤—Å–µ —Å—Ä–∞–∑—É
2. __–ü–∞–º—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞__: –í–µ–∫—Ç–æ—Ä $h_t$ —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–±–æ –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–ª–æ–≤–∞—Ö
3. __–û–¥–Ω–∏ –∏ —Ç–µ –∂–µ –≤–µ—Å–∞__: –ú–∞—Ç—Ä–∏—Ü—ã $W_{hh}$, $W_{xh}$, $W_{hy}$ - –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –¥–ª—è –≤—Å–µ—Ö —à–∞–≥–æ–≤
4. __–¶–µ–ø–æ—á–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π__: $h_3$ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_2$, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_1$, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_0$

# –ö–∞–∫–∏–µ –µ—Å—Ç—å –ø–ª—é—Å –∏ –º–∏–Ω—É—Å—ã —É RNN?

## ‚úÖ –ü–ª—é—Å—ã

### 1. __–†–∞–±–æ—Ç–∞ —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã__

- –ú–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—ã –ª—é–±–æ–π –¥–ª–∏–Ω—ã (–æ—Ç 1 —Å–ª–æ–≤–∞ –¥–æ —Ü–µ–ª–æ–π –∫–Ω–∏–≥–∏)
- –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ RNN —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏ –∏–∑ 3 —Å–ª–æ–≤ –∏ –∏–∑ 100 —Å–ª–æ–≤

### 2. __–ü–∞–º—è—Ç—å –æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ__

- –ó–∞–ø–æ–º–∏–Ω–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–ª–æ–≤–∞ –≤ –≤–µ–∫—Ç–æ—Ä–µ $h_t$
- –ü–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ "—è–±–ª–æ–∫–æ" –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ "—è –µ–º —è–±–ª–æ–∫–æ" - —ç—Ç–æ –µ–¥–∞, –∞ –≤ "Apple –≤—ã–ø—É—Å—Ç–∏–ª–∞ iPhone" - —ç—Ç–æ –∫–æ–º–ø–∞–Ω–∏—è

### 3. __–ù–µ–±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤__

- –û–¥–Ω–∏ –∏ —Ç–µ –∂–µ –≤–µ—Å–∞ $W_{hh}$, $W_{xh}$, $W_{hy}$ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ–≤
- –ù–µ —Ä–∞—Å—Ç–µ—Ç —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞ (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã—Ö —Å–µ—Ç–µ–π)

### 4. __–£—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤__

- "–°–æ–±–∞–∫–∞ –∫—É—Å–∞–µ—Ç —á–µ–ª–æ–≤–µ–∫–∞" ‚â† "–ß–µ–ª–æ–≤–µ–∫ –∫—É—Å–∞–µ—Ç —Å–æ–±–∞–∫—É"
- –ü–æ—Ä—è–¥–æ–∫ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –∏ RNN —ç—Ç–æ –ø–æ–Ω–∏–º–∞–µ—Ç

## ‚ùå –ú–∏–Ω—É—Å—ã

### __–ü—Ä–æ–±–ª–µ–º–∞ –∑–∞—Ç—É—Ö–∞—é—â–∏—Ö/–≤–∑—Ä—ã–≤–∞—é—â–∏—Ö—Å—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤__

__–°–∞–º–∞—è –∫—Ä–∏—Ç–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞!__

–ü—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ backpropagation —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è (BPTT), –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã —É–º–Ω–æ–∂–∞—é—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ:

$$\frac{\partial L}{\partial h_1} = \frac{\partial L}{\partial h_T} \cdot \prod_{t=2}^{T} \frac{\partial h_t}{\partial h_{t-1}}$$

__–ü—Ä–æ–±–ª–µ–º–∞:__

- –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è < 1: –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã __–∑–∞—Ç—É—Ö–∞—é—Ç__ (vanishing gradients) ‚Üí —Å–µ—Ç—å –Ω–µ —É—á–∏—Ç –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è > 1: –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã __–≤–∑—Ä—ã–≤–∞—é—Ç—Å—è__ (exploding gradients) ‚Üí –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

__–ü—Ä–∏–º–µ—Ä:__

```javascript
–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ: "–ö–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –∂–∏–ª —É –±–∞–±—É—à–∫–∏ –≤ –¥–µ—Ä–µ–≤–Ω–µ –ø—Ä–æ—à–ª—ã–º –ª–µ—Ç–æ–º, –±—ã–ª —Ä—ã–∂–∏–º"

RNN –ø–ª–æ—Ö–æ –∑–∞–ø–æ–º–Ω–∏—Ç —Å–≤—è–∑—å "–∫–æ—Ç" ‚Üí "–±—ã–ª —Ä—ã–∂–∏–º" –∏–∑-–∑–∞ –±–æ–ª—å—à–æ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
```

### 2. __–ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (–Ω–µ–ª—å–∑—è —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å)__

- –ù—É–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–ª–æ–≤–æ 1, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å $h_1$
- –ü–æ—Ç–æ–º —Å–ª–æ–≤–æ 2, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å $h_2$
- –ò —Ç–∞–∫ –¥–∞–ª–µ–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ ‚ùå –Ω–µ –ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—Å—è
- –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Transformers, –≥–¥–µ –≤—Å–µ —Å–ª–æ–≤–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

### 3. __–ö–æ—Ä–æ—Ç–∫–∞—è –ø–∞–º—è—Ç—å__

- –í —Ç–µ–æ—Ä–∏–∏ $h_t$ —Ö—Ä–∞–Ω–∏—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ –Ω–∞—á–∞–ª–∞ –¥–ª–∏–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ "–∑–∞–±—ã–≤–∞–µ—Ç—Å—è"
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å: –æ–±—ã—á–Ω–æ 5-10 —Å–ª–æ–≤ –Ω–∞–∑–∞–¥

# –ö–∞–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å —É RNN ?

## –í—ã–≤–æ–¥ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (Forward Pass)

### –®–∞–≥ 1: –ê–Ω–∞–ª–∏–∑ –æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —à–∞–≥–∞

–§–æ—Ä–º—É–ª–∞ –Ω–∞ –æ–¥–Ω–æ–º —à–∞–≥–µ $t$:

$$h_t = \tanh(W_{hh} \cdot h_{t-1} + W_{xh} \cdot x_t + b_h)$$

__–û–ø–µ—Ä–∞—Ü–∏–∏ —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü:__

1. __$W_{hh} \cdot h_{t-1}$__

   - $W_{hh}$: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å $[h \times h]$
   - $h_{t-1}$: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å $[h \times 1]$
   - –°–ª–æ–∂–Ω–æ—Å—Ç—å: $O(h^2)$ –æ–ø–µ—Ä–∞—Ü–∏–π

2. __$W_{xh} \cdot x_t$__

   - $W_{xh}$: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å $[h \times d]$
   - $x_t$: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å $[d \times 1]$
   - –°–ª–æ–∂–Ω–æ—Å—Ç—å: $O(h \cdot d)$ –æ–ø–µ—Ä–∞—Ü–∏–π

3. __–°–ª–æ–∂–µ–Ω–∏–µ –∏ tanh__

   - –°–ª–æ–∂–Ω–æ—Å—Ç—å: $O(h)$ –æ–ø–µ—Ä–∞—Ü–∏–π

__–ò—Ç–æ–≥–æ –¥–ª—è –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞:__

$$\text{Complexity}_{\text{step}} = O(h^2 + h \cdot d + h) = O(h^2 + h \cdot d)$$

(–£–ø—Ä–æ—â–∞–µ–º, —Ç–∞–∫ –∫–∞–∫ $h^2$ –∏ $h \cdot d$ –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç –Ω–∞–¥ $h$)

---

### –®–∞–≥ 2: –î–ª—è –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–£ –Ω–∞—Å $T$ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤, –∫–∞–∂–¥—ã–π —Å —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é $O(h^2 + h \cdot d)$:

$$\boxed{\text{Forward Pass} = O(T \cdot (h^2 + h \cdot d))}$$

---

### –®–∞–≥ 3: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –≤—ã—Ö–æ–¥ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ:

$$y_t = W_{hy} \cdot h_t + b_y$$

- $W_{hy}$: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å $[V \times h]$
- $h_t$: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å $[h \times 1]$
- –°–ª–æ–∂–Ω–æ—Å—Ç—å: $O(V \cdot h)$ –Ω–∞ –∫–∞–∂–¥—ã–π —à–∞–≥

__–° —É—á–µ—Ç–æ–º –≤—ã—Ö–æ–¥–∞:__

$$\text{Forward Pass (full)} = O(T \cdot (h^2 + h \cdot d + V \cdot h))$$

## –í—ã–≤–æ–¥ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ Backward Pass (BPTT)

__Backpropagation Through Time (BPTT):__

–ü—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:

$$\frac{\partial L}{\partial W_{hh}} = \sum_{t=1}^{T} \frac{\partial L}{\partial h_t} \cdot \frac{\partial h_t}{\partial W_{hh}}$$

__–°–ª–æ–∂–Ω–æ—Å—Ç—å:__

- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ $T$ —à–∞–≥–æ–≤ –Ω—É–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
- –û–ø–µ—Ä–∞—Ü–∏–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã forward pass (—É–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü)

$$\boxed{\text{Backward Pass (BPTT)} = O(T \cdot (h^2 + h \cdot d))}$$

## –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

- $T = 50$ (–¥–ª–∏–Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
- $d = 300$ (—Ä–∞–∑–º–µ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–∞)
- $h = 512$ (—Ä–∞–∑–º–µ—Ä —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è)
- $V = 30,000$ (—Ä–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è)

### Forward Pass:

$$T \cdot (h^2 + h \cdot d) = 50 \cdot (512^2 + 512 \cdot 300)$$ $$= 50 \cdot (262,144 + 153,600) = 50 \cdot 415,744$$ $$= 20,787,200 \text{ –æ–ø–µ—Ä–∞—Ü–∏–π} \approx 20.8M \text{ ops}$$

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

$$h^2 + h \cdot d + V \cdot h = 512^2 + 512 \cdot 300 + 30,000 \cdot 512$$ $$= 262,144 + 153,600 + 15,360,000$$ $$= 15,775,744 \text{ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤} \approx 15.8M \text{ params}$$

# –ß—Ç–æ —Ç–∞–∫–æ–µ transformers (—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã)? –ß–µ–º –æ–Ω–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç RNN ?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –Ω–∞ —Å–æ–≤–µ—â–∞–Ω–∏–∏ —Å 10 –ª—é–¥—å–º–∏. –ö–æ–≥–¥–∞ –∫—Ç–æ-—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç —Å–ª–æ–≤–æ, __–≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å–º–æ—Ç—Ä—è—Ç –Ω–∞ –Ω–µ–≥–æ –∏ —Ä–µ—à–∞—é—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ç–æ —Å–ª–æ–≤–æ –≤–∞–∂–Ω–æ –¥–ª—è –∏—Ö –ø–æ–Ω–∏–º–∞–Ω–∏—è__. –≠—Ç–æ –∏ –µ—Å—Ç—å self-attention!

__RNN__ = —á–µ–ª–æ–≤–µ–∫ —á–∏—Ç–∞–µ—Ç —Ç–µ–∫—Å—Ç __—Å–ª–æ–≤–æ –∑–∞ —Å–ª–æ–≤–æ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ__\
__Transformer__ = –≥—Ä—É–ø–ø–∞ –ª—é–¥–µ–π —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ __–≤—Å–µ —Å–ª–æ–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ__ –∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç, –∫–∞–∫–∏–µ —Å–ª–æ–≤–∞ —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π

## –ú–µ—Ö–∞–Ω–∏–∑–º Self-Attention

### –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è: Query, Key, Value (QKV)

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É:

- __Query (Q)__ = "–ß—Ç–æ —è –∏—â—É?" (–∑–∞–ø—Ä–æ—Å)
- __Key (K)__ = "–ß—Ç–æ —è –ø—Ä–µ–¥–ª–∞–≥–∞—é?" (–∫–ª—é—á)
- __Value (V)__ = "–ö–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —è –¥–∞—é?" (–∑–Ω–∞—á–µ–Ω–∏–µ)

### –ü—Ä–∏–º–µ—Ä —Å "—è —Ö–æ—á—É –ø–∏—Ü—Ü—É"

__–î–æ–ø—É—Å—Ç–∏–º, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–ª–æ–≤–æ "–ø–∏—Ü—Ü—É":__

1. __Query –æ—Ç "–ø–∏—Ü—Ü—É"__: "–Ø –∏—â—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –∫—Ç–æ –∏ —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Å –ø–∏—Ü—Ü–µ–π"

2. __Keys –æ—Ç –¥—Ä—É–≥–∏—Ö —Å–ª–æ–≤:__

   - Key("—è"): "–Ø —Å—É–±—ä–µ–∫—Ç –¥–µ–π—Å—Ç–≤–∏—è"
   - Key("—Ö–æ—á—É"): "–Ø –≥–ª–∞–≥–æ–ª –∂–µ–ª–∞–Ω–∏—è"
   - Key("–ø–∏—Ü—Ü—É"): "–Ø –æ–±—ä–µ–∫—Ç –¥–µ–π—Å—Ç–≤–∏—è"

3. __–°—Ä–∞–≤–Ω–µ–Ω–∏–µ Query —Å Keys__ (–≤—ã—á–∏—Å–ª—è–µ–º "–ø–æ—Ö–æ–∂–µ—Å—Ç—å"):

   ```javascript
   Attention("–ø–∏—Ü—Ü—É" ‚Üí "—è")    = 0.3  (—Å—Ä–µ–¥–Ω—è—è –≤–∞–∂–Ω–æ—Å—Ç—å)
   Attention("–ø–∏—Ü—Ü—É" ‚Üí "—Ö–æ—á—É") = 0.6  (–≤—ã—Å–æ–∫–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å!) ‚Üê —Å–≤—è–∑–∞–Ω—ã!
   Attention("–ø–∏—Ü—Ü—É" ‚Üí "–ø–∏—Ü—Ü—É") = 0.1  (–Ω–∏–∑–∫–∞—è, —Å–∞–º —Å —Å–æ–±–æ–π)
   ```

4. __–í–∑–≤–µ—à–∏–≤–∞–µ–º Values:__

   ```javascript
   –ù–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ "–ø–∏—Ü—Ü—É" = 
       0.3 √ó Value("—è") + 
       0.6 √ó Value("—Ö–æ—á—É") +  ‚Üê –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ—Ç "—Ö–æ—á—É"
       0.1 √ó Value("–ø–∏—Ü—Ü—É")
   ```

__–†–µ–∑—É–ª—å—Ç–∞—Ç:__ "–ø–∏—Ü—Ü—É" —Ç–µ–ø–µ—Ä—å "–∑–Ω–∞–µ—Ç", —á—Ç–æ –µ–≥–æ "—Ö–æ—á—É—Ç"!

### –§–æ—Ä–º—É–ª–∞ 1: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ QKV

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ $x_i$ –≤—ã—á–∏—Å–ª—è–µ–º —Ç—Ä–∏ –≤–µ–∫—Ç–æ—Ä–∞:

$$Q_i = W_Q \cdot x_i$$ $$K_i = W_K \cdot x_i$$ $$V_i = W_V \cdot x_i$$

### –§–æ—Ä–º—É–ª–∞ 2: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ Attention Scores

$$\text{Attention}(Q, K, V) = \text{softmax}\left(\frac{Q \cdot K^T}{\sqrt{d_k}}\right) \cdot V$$

__–†–∞–∑–±–æ—Ä –ø–æ —à–∞–≥–∞–º:__

#### –®–∞–≥ 1: –í—ã—á–∏—Å–ª—è–µ–º "–ø–æ—Ö–æ–∂–µ—Å—Ç—å" (scores)

$$\text{scores} = Q \cdot K^T$$

–≠—Ç–æ __—Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ__ Query —Å –∫–∞–∂–¥—ã–º Key:

```javascript
–î–ª—è —Å–ª–æ–≤–∞ "–ø–∏—Ü—Ü—É":
Q("–ø–∏—Ü—Ü—É") ¬∑ K("—è")    = —á–∏—Å–ª–æ (–Ω–∞—Å–∫–æ–ª—å–∫–æ –ø–æ—Ö–æ–∂–∏)
Q("–ø–∏—Ü—Ü—É") ¬∑ K("—Ö–æ—á—É") = —á–∏—Å–ª–æ (–Ω–∞—Å–∫–æ–ª—å–∫–æ –ø–æ—Ö–æ–∂–∏)
Q("–ø–∏—Ü—Ü—É") ¬∑ K("–ø–∏—Ü—Ü—É") = —á–∏—Å–ª–æ (–Ω–∞—Å–∫–æ–ª—å–∫–æ –ø–æ—Ö–æ–∂–∏)
```

#### –®–∞–≥ 2: –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º (–¥–µ–ª–∏–º –Ω–∞ $\sqrt{d_k}$)

$$\text{scaled-scores} = \frac{Q \cdot K^T}{\sqrt{d_k}}$$

__–ó–∞—á–µ–º –¥–µ–ª–∏—Ç—å –Ω–∞ $\sqrt{d_k}$?__

- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –±–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏
- –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏
- –û–±—ã—á–Ω–æ $d_k = 64$, —Ç–æ–≥–¥–∞ $\sqrt{d_k} = 8$

#### –®–∞–≥ 3: –ü—Ä–∏–º–µ–Ω—è–µ–º softmax

$$\text{attention-weights} = \text{softmax}\left(\frac{Q \cdot K^T}{\sqrt{d_k}}\right)$$

__Softmax__ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç scores –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (—Å—É–º–º–∞ = 1):

```javascript
–î–ª—è "–ø–∏—Ü—Ü—É":
scores = [5.2, 8.7, 2.1]  ‚Üí softmax ‚Üí  weights = [0.15, 0.82, 0.03]
                                                      ‚Üë
                                        "—Ö–æ—á—É" —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π!
```

#### –®–∞–≥ 4: –í–∑–≤–µ—à–∏–≤–∞–µ–º Values

$$\text{output} = \text{attention-weights} \cdot V$$

```javascript
–ù–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ = 0.15 √ó V("—è") + 0.82 √ó V("—Ö–æ—á—É") + 0.03 √ó V("–ø–∏—Ü—Ü—É")
```

## üé® Multi-Head Attention (–ú–Ω–æ–≥–æ –≥–æ–ª–æ–≤)

__–ò–¥–µ—è:__ –†–∞–∑–Ω—ã–µ "–≥–æ–ª–æ–≤—ã" —Å–º–æ—Ç—Ä—è—Ç –Ω–∞ —Ä–∞–∑–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã —Å–≤—è–∑–µ–π.

### –ü—Ä–∏–º–µ—Ä –¥–ª—è "—è —Ö–æ—á—É –ø–∏—Ü—Ü—É":

__Head 1__ (—Ñ–æ–∫—É—Å –Ω–∞ —Å—É–±—ä–µ–∫—Ç-–≥–ª–∞–≥–æ–ª):

```javascript
"—è"    ‚îÄ‚îÄ–≤—ã—Å–æ–∫–∞—è —Å–≤—è–∑—å‚îÄ‚îÄ‚ñ∫ "—Ö–æ—á—É"
"—Ö–æ—á—É" ‚îÄ‚îÄ–≤—ã—Å–æ–∫–∞—è —Å–≤—è–∑—å‚îÄ‚îÄ‚ñ∫ "—è"
```

__Head 2__ (—Ñ–æ–∫—É—Å –Ω–∞ –≥–ª–∞–≥–æ–ª-–æ–±—ä–µ–∫—Ç):

```javascript
"—Ö–æ—á—É"  ‚îÄ‚îÄ–≤—ã—Å–æ–∫–∞—è —Å–≤—è–∑—å‚îÄ‚îÄ‚ñ∫ "–ø–∏—Ü—Ü—É"
"–ø–∏—Ü—Ü—É" ‚îÄ‚îÄ–≤—ã—Å–æ–∫–∞—è —Å–≤—è–∑—å‚îÄ‚îÄ‚ñ∫ "—Ö–æ—á—É"
```

__Head 3__ (—Ñ–æ–∫—É—Å –Ω–∞ –¥–∞–ª—å–Ω–∏–µ —Å–≤—è–∑–∏):

```javascript
"—è" ‚îÄ‚îÄ—Å—Ä–µ–¥–Ω—è—è —Å–≤—è–∑—å‚îÄ‚îÄ‚ñ∫ "–ø–∏—Ü—Ü—É"
```

__–§–æ—Ä–º—É–ª–∞:__

$$\text{MultiHead}(Q,K,V) = \text{Concat}(\text{head}_1, ..., \text{head}_h) \cdot W_O$$

–≥–¥–µ –∫–∞–∂–¥–∞—è –≥–æ–ª–æ–≤–∞:

$$\text{head}_i = \text{Attention}(Q \cdot W_i^Q, K \cdot W_i^K, V \cdot W_i^V)$$

---

## üî¢ Positional Encoding (–ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π)

__–ü—Ä–æ–±–ª–µ–º–∞:__ Transformer –≤–∏–¥–∏—Ç –≤—Å–µ —Å–ª–æ–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ ‚Üí –Ω–µ –∑–Ω–∞–µ—Ç –ø–æ—Ä—è–¥–æ–∫!

"—è —Ö–æ—á—É –ø–∏—Ü—Ü—É" vs "–ø–∏—Ü—Ü—É —Ö–æ—á—É —è" ‚Üí __–±–µ–∑ –ø–æ–∑–∏—Ü–∏–π –≤—ã–≥–ª—è–¥—è—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ__ ‚ùå

__–†–µ—à–µ–Ω–∏–µ:__ –î–æ–±–∞–≤–ª—è–µ–º –∫ —ç–º–±–µ–¥–¥–∏–Ω–≥—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–∑–∏—Ü–∏–∏.

### –§–æ—Ä–º—É–ª–∞:

$$PE_{(pos, 2i)} = \sin\left(\frac{pos}{10000^{2i/d_{model}}}\right)$$

$$PE_{(pos, 2i+1)} = \cos\left(\frac{pos}{10000^{2i/d_{model}}}\right)$$

__–ì–¥–µ:__

- $pos$ - –ø–æ–∑–∏—Ü–∏—è —Å–ª–æ–≤–∞ (0, 1, 2, ...)
- $i$ - –∏–Ω–¥–µ–∫—Å –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤ –≤–µ–∫—Ç–æ—Ä–µ
- $d_{model}$ - —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞

__–ü—Ä–∏–º–µ—Ä –¥–ª—è "—è —Ö–æ—á—É –ø–∏—Ü—Ü—É":__

```javascript
"—è"    (pos=0): embedding + PE(0) = [0.2, -0.5, ...] + [0.0, 1.0, 0.0, ...]
"—Ö–æ—á—É" (pos=1): embedding + PE(1) = [0.5, 0.3, ...]  + [0.84, 0.54, ...]
"–ø–∏—Ü—Ü—É"(pos=2): embedding + PE(2) = [-0.1, 0.7, ...] + [0.91, -0.42, ...]
```

–¢–µ–ø–µ—Ä—å –º–æ–¥–µ–ª—å __–∑–Ω–∞–µ—Ç –ø–æ—Ä—è–¥–æ–∫__! ‚úÖ

---

## ‚úÖ –ü–ª—é—Å—ã –∏ ‚ùå –ú–∏–Ω—É—Å—ã Transformer

### ‚úÖ –ü–ª—é—Å—ã (–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞)

#### 1. __–ü–æ–ª–Ω–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è__ ‚ö°

- –í—Å–µ —Å–ª–æ–≤–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è __–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ__
- –û–±—É—á–µ–Ω–∏–µ –≤ 10-100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ RNN
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GPU

#### 2. __–ù–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã –∑–∞—Ç—É—Ö–∞—é—â–∏—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤__

- –ö–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –Ω–∞–ø—Ä—è–º—É—é —Å–≤—è–∑–∞–Ω–æ —Å –∫–∞–∂–¥—ã–º
- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
- –ù–µ—Ç –¥–ª–∏–Ω–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∫–∞–∫ –≤ RNN

#### 3. __–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏__

```javascript
"–Ø —Ä–æ–¥–∏–ª—Å—è –≤–æ –§—Ä–∞–Ω—Ü–∏–∏... (1000 —Å–ª–æ–≤)... –ø–æ—ç—Ç–æ–º—É –≥–æ–≤–æ—Ä—é –ø–æ-—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏"
         ‚Üë                                              ‚Üë
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ø—Ä—è–º–∞—è —Å–≤—è–∑—å ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

Transformer __–ª–µ–≥–∫–æ__ —Å–≤—è–∑—ã–≤–∞–µ—Ç –¥–∞–ª—ë–∫–∏–µ —Å–ª–æ–≤–∞!

#### 4. __–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å__

- –ú–æ–∂–Ω–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å attention weights
- –í–∏–¥–Ω–æ, –∫–∞–∫–∏–µ —Å–ª–æ–≤–∞ —Å–≤—è–∑–∞–Ω—ã
- –ü–æ–Ω—è—Ç–Ω–æ, –Ω–∞ —á—Ç–æ –º–æ–¥–µ–ª—å —Å–º–æ—Ç—Ä–∏—Ç

### ‚ùå –ú–∏–Ω—É—Å—ã (–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏)

#### 1. __–ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ –¥–ª–∏–Ω–µ__

$$O(T^2 \cdot d)$$

__–ü—Ä–æ–±–ª–µ–º–∞:__

- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤ 100 —Å–ª–æ–≤ ‚Üí $100^2 = 10,000$ —Å–≤—è–∑–µ–π
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤ 1000 —Å–ª–æ–≤ ‚Üí $1,000^2 = 1,000,000$ —Å–≤—è–∑–µ–π ‚ùå

__–†–µ—à–µ–Ω–∏—è:__

- Sparse Attention (—Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ)
- Longformer, BigBird (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)

#### 2. __–ú–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤__

- –¢–∏–ø–∏—á–Ω–∞—è –º–æ–¥–µ–ª—å: 110M - 175B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –¢—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏ (GPU/TPU)
- –î–æ—Ä–æ–≥–æ–µ –æ–±—É—á–µ–Ω–∏–µ

#### 3. __–¢—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è__

- RNN: –º–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å –Ω–∞ 10k –ø—Ä–∏–º–µ—Ä–∞—Ö
- Transformer: –Ω—É–∂–Ω–æ 100k+ –ø—Ä–∏–º–µ—Ä–æ–≤
- –°–∫–ª–æ–Ω–µ–Ω –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –Ω–∞ –º–∞–ª—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### 4. __–ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞__

- –ù—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π Positional Encoding
- –ù–µ —Ç–∞–∫ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–∞–∫ RNN

# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ - —á—Ç–æ —Ç–∞–∫–æ–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏?

–ü–æ —Å—É—Ç–∏ —ç—Ç–æ –µ–º–±–µ–¥–¥–∏–Ω–≥ —Å —É—á–µ—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–ª–æ–≤–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞–ø—Ä–∏–º–µ—Ä —Å–ª–æ–≤–∞ "mouse" –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å –∫–∞–∫ –æ–±—ã—á–Ω—É—é –º—ã—à—å, —Ç–∞–∫ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—É—é –∏ –≤ —ç—Ç–∏—Ö –¥–≤—É—Ö —Å–ª—É—á–∞—è—Ö –º—ã –¥–æ–ª–∂–Ω—ã –ø–æ —Ä–∞–∑–Ω–æ–º—É –Ω–∞ –Ω–µ–≥–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–æ–ª—É—á–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —ç–º–±–µ–¥–∏–Ω–≥–∏. 

# –ù—É–∂–Ω–æ –ª–∏ –≤ transformers –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–µ–∫—Å—Ç–∞?

–ù–µ—Ç –Ω–µ –Ω—É–∂–Ω–æ, –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–º–Ω—ã–µ —á—Ç–æ–±—ã —É–º–µ—Ç—å –æ—Ä–∏–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç–µ–∫—Å—Ç–µ –±–µ–∑ —ç—Ç–æ–≥–æ. 

# –ß—Ç–æ —Ç–∞–∫–æ–µ —Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä? –ö–∞–∫–∏–µ –≤–∏–¥—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É:

- __–¢–æ–∫–µ–Ω__ = __–Ω–æ–º–µ—Ä –∫–Ω–∏–≥–∏__ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–Ω–∏–≥–∞ #245)
- __–≠–º–±–µ–¥–¥–∏–Ω–≥__ = __—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∫–Ω–∏–≥–∏__ (–µ—ë —Å–º—ã—Å–ª, —Ç–µ–º—ã, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ)

–ù–æ–º–µ—Ä - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –º–µ—Ç–∫–∞, —Ü–∏—Ñ—Ä–∞. –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ - —ç—Ç–æ —Ä–µ–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

–ò –∑–∞–¥–∞—á–∞ —Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä–∞ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å —Å–ª–æ–≤–æ –≤ —á–∏—Å–ª–æ. –ê –∑–∞–¥–∞—á–µ –µ–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —É–∂–µ –ø–æ —ç—Ç–æ–º—É —á–∏—Å–ª—É –¥–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ.

## üìö –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

### –¢–æ–∫–µ–Ω

__–¢–æ–∫–µ–Ω__ = –¥–∏—Å–∫—Ä–µ—Ç–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ —Ç–µ–∫—Å—Ç–∞ + –µ—ë —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ)

```javascript
–°–ª–æ–≤–æ "–ø–∏—Ü—Ü—É" ‚Üí –¢–æ–∫–µ–Ω "–ø–∏—Ü—Ü—É" ‚Üí ID: 8942
                    ‚Üë              ‚Üë
                  —Å—Ç—Ä–æ–∫–∞         —á–∏—Å–ª–æ
```

__–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:__

- –î–∏—Å–∫—Ä–µ—Ç–Ω—ã–π (–æ—Ç–¥–µ–ª—å–Ω—ã–π, –Ω–µ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π)
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
- –ù–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–º–∞–Ω—Ç–∏–∫–∏ (—Å–º—ã—Å–ª–∞)
- –ü—Ä–æ—Å—Ç–æ –º–µ—Ç–∫–∞

---

### –≠–º–±–µ–¥–¥–∏–Ω–≥ (Embedding)

__–≠–º–±–µ–¥–¥–∏–Ω–≥__ = –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ

```javascript
–¢–æ–∫–µ–Ω "–ø–∏—Ü—Ü—É" (ID: 8942) ‚Üí –≠–º–±–µ–¥–¥–∏–Ω–≥: [0.23, -0.51, 0.87, 0.12, ..., -0.34]
                                        ‚Üë
                                  –≤–µ–∫—Ç–æ—Ä –∏–∑ 300-768 —á–∏—Å–µ–ª
```

```javascript
–¢–µ–∫—Å—Ç: "—è —Ö–æ—á—É –ø–∏—Ü—Ü—É"
        ‚Üì –¢–û–ö–ï–ù–ê–ô–ó–ï–† ‚Üì
–¢–æ–∫–µ–Ω—ã: ["—è", "—Ö–æ—á—É", "–ø–∏—Ü—Ü—É"]
        ‚Üì
ID —Ç–æ–∫–µ–Ω–æ–≤: [245, 1567, 8942]
        ‚Üì
–ù–µ–π—Ä–æ—Å–µ—Ç—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–∏—Å–ª–∞
```

### –§–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

__–¢–æ–∫–µ–Ω–∞–π–∑–µ—Ä__ = –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π:

1. –†–∞–∑–±–∏–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ __—Ç–æ–∫–µ–Ω—ã__ (—á–∞—Å—Ç–∏)
2. –°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–∞–∂–¥–æ–º—É —Ç–æ–∫–µ–Ω—É __—É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID__ (—á–∏—Å–ª–æ)
3. –°–æ–∑–¥–∞—ë—Ç __—Å–ª–æ–≤–∞—Ä—å__ (vocabulary) —Ç–æ–∫–µ–Ω ‚Üî ID

![](./images/tokenizers.png)

# –ú–æ–∂–Ω–æ –ª–∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å —Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä? –ò –≤ –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö —ç—Ç–æ —Å—Ç–æ–∏—Ç –¥–µ–ª–∞—Ç—å?

## üî§ –î–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –≤–∏–¥–∞ —Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä–æ–≤

### 1. Word-based (–ù–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–æ–≤)

__–ü—Ä–∏–Ω—Ü–∏–ø:__ –ö–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ = –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω

#### –ü—Ä–∏–º–µ—Ä:

```javascript
–¢–µ–∫—Å—Ç: "—è —Ö–æ—á—É –±–æ–ª—å—à—É—é –≤–∫—É—Å–Ω—É—é –ø–∏—Ü—Ü—É"

–¢–æ–∫–µ–Ω—ã: ["—è", "—Ö–æ—á—É", "–±–æ–ª—å—à—É—é", "–≤–∫—É—Å–Ω—É—é", "–ø–∏—Ü—Ü—É"]

–°–ª–æ–≤–∞—Ä—å:
{
  "—è": 0,
  "—Ö–æ—á—É": 1,
  "–±–æ–ª—å—à—É—é": 2,
  "–≤–∫—É—Å–Ω—É—é": 3,
  "–ø–∏—Ü—Ü—É": 4,
  ...
}

ID: [0, 1, 2, 3, 4]
```

#### ‚úÖ –ü–ª—é—Å—ã:

- __–ü—Ä–æ—Å—Ç–æ—Ç–∞__ - –ª–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
- __–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å__ - –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω = –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ–µ —Å–ª–æ–≤–æ
- __–†–∞–∑–º–µ—Ä —Ç–æ–∫–µ–Ω–æ–≤__ - –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π (1 —Ç–æ–∫–µ–Ω = 1 —Å–ª–æ–≤–æ)

#### ‚ùå –ú–∏–Ω—É—Å—ã:

- __–û–≥—Ä–æ–º–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å__ - –º–∏–ª–ª–∏–æ–Ω—ã —Å–ª–æ–≤ –≤ —è–∑—ã–∫–µ

  ```javascript
  "–±–µ–∂–∞—Ç—å", "–±–µ–≥—É", "–±–µ–∂–∞–ª", "–±–µ–∂–∞–ª–∞", "–ø–æ–±–µ–≥—É" ‚Üí 5 —Ä–∞–∑–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤!
  ```

- __OOV (Out-of-Vocabulary)__ - –Ω–æ–≤—ã–µ/—Ä–µ–¥–∫–∏–µ —Å–ª–æ–≤–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è

  ```javascript
  –°–ª–æ–≤–∞—Ä—å: ["—è", "—Ö–æ—á—É", "–ø–∏—Ü—Ü—É"]
  –¢–µ–∫—Å—Ç: "—è —Ö–æ—á—É —à–∞—É—Ä–º—É" ‚Üí "—à–∞—É—Ä–º—É" = [UNK] (–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ)
  ```

- __–ü–∞–º—è—Ç—å__ - –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –æ–≥—Ä–æ–º–Ω—É—é embedding –º–∞—Ç—Ä–∏—Ü—É

  ```javascript
  –°–ª–æ–≤–∞—Ä—å 100,000 —Å–ª–æ–≤ √ó 512 —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å = 51,200,000 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  ```

#### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:

```python
# Word-based tokenizer
text = "—è —Ö–æ—á—É –ø–∏—Ü—Ü—É"
tokens = text.split()  # ["—è", "—Ö–æ—á—É", "–ø–∏—Ü—Ü—É"]
vocab = {"—è": 0, "—Ö–æ—á—É": 1, "–ø–∏—Ü—Ü—É": 2}
ids = [vocab[token] for token in tokens]  # [0, 1, 2]
```

---

### 2. Subword-based (–ù–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–¥—Å–ª–æ–≤)

__–ü—Ä–∏–Ω—Ü–∏–ø:__ –†–∞–∑–±–∏–≤–∞–µ–º —Å–ª–æ–≤–∞ –Ω–∞ __—á–∞—Å—Ç–∏__ (–ø–æ–¥—Å–ª–æ–≤–∞), –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —á–∞—Å—Ç–æ

#### –¢—Ä–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞:

##### A) BPE (Byte Pair Encoding)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤: GPT-2, GPT-3, GPT-4, RoBERTa

__–ê–ª–≥–æ—Ä–∏—Ç–º:__

1. –ù–∞—á–∏–Ω–∞–µ–º —Å —Å–∏–º–≤–æ–ª–æ–≤
2. –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è–µ–º __—Å–∞–º—ã–µ —á–∞—Å—Ç—ã–µ –ø–∞—Ä—ã__ —Ç–æ–∫–µ–Ω–æ–≤
3. –ü–æ–≤—Ç–æ—Ä—è–µ–º –¥–æ –Ω—É–∂–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å–ª–æ–≤–∞—Ä—è

__–ü—Ä–∏–º–µ—Ä –æ–±—É—á–µ–Ω–∏—è BPE:__

```javascript
–®–∞–≥ 0: –ù–∞—á–∞–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã (—Å–∏–º–≤–æ–ª—ã)
–¢–µ–∫—Å—Ç: "–ø–∏—Ü—Ü—É –ø–∏—Ü—Ü–∞ –ø–∏—Ü—Ü–µ"
–¢–æ–∫–µ–Ω—ã: ["–ø", "–∏", "—Ü", "—Ü", "—É", " ", "–ø", "–∏", "—Ü", "—Ü", "–∞", ...]

–®–∞–≥ 1: –°–∞–º–∞—è —á–∞—Å—Ç–∞—è –ø–∞—Ä–∞ = ("—Ü", "—Ü") –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è 3 —Ä–∞–∑–∞
–û–±—ä–µ–¥–∏–Ω—è–µ–º: "—Ü—Ü" ‚Üí –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
–°–ª–æ–≤–∞—Ä—å: ["–ø", "–∏", "—Ü", "—É", "–∞", "–µ", "—Ü—Ü"]

–®–∞–≥ 2: –°–∞–º–∞—è —á–∞—Å—Ç–∞—è –ø–∞—Ä–∞ = ("–ø", "–∏")
–û–±—ä–µ–¥–∏–Ω—è–µ–º: "–ø–∏" ‚Üí –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
–°–ª–æ–≤–∞—Ä—å: ["–ø", "–∏", "—Ü", "—É", "–∞", "–µ", "—Ü—Ü", "–ø–∏"]

–®–∞–≥ 3: –°–∞–º–∞—è —á–∞—Å—Ç–∞—è –ø–∞—Ä–∞ = ("–ø–∏", "—Ü—Ü")
–û–±—ä–µ–¥–∏–Ω—è–µ–º: "–ø–∏—Ü—Ü" ‚Üí –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
...–∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
```

__–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏:__

```javascript
"—è —Ö–æ—á—É –±–æ–ª—å—à—É—é –ø–∏—Ü—Ü—É"
‚Üí ["—è", "—Ö–æ—á", "—É", "–±–æ–ª—å—à", "—É—é", "–ø–∏—Ü—Ü", "—É"]
```

##### B) WordPiece

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤: BERT, DistilBERT

__–û—Ç–ª–∏—á–∏–µ –æ—Ç BPE:__ –í—ã–±–∏—Ä–∞–µ—Ç –ø–∞—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ __–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏__, –∞ –Ω–µ —á–∞—Å—Ç–æ—Ç—ã

__–ü—Ä–∏–º–µ—Ä:__

```javascript
"–Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–π" ‚Üí ["–Ω–µ", "##–ø–æ–Ω—è—Ç", "##–Ω—ã–π"]
               ‚Üë      ‚Üë           ‚Üë
            –Ω–∞—á–∞–ª–æ  –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ
            
–ü—Ä–µ—Ñ–∏–∫—Å "##" –æ–∑–Ω–∞—á–∞–µ—Ç "–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–ª–æ–≤–∞"
```

##### C) Unigram

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤: T5, mBART

__–ü—Ä–∏–Ω—Ü–∏–ø:__ –ù–∞—á–∏–Ω–∞–µ–º —Å –±–æ–ª—å—à–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ __—É–¥–∞–ª—è–µ–º__ —Ä–µ–¥–∫–∏–µ —Ç–æ–∫–µ–Ω—ã


# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ - –ú–æ–∂–Ω–æ –ª–∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å —Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä? –ò –≤ –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö —ç—Ç–æ —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

### –ú–æ–∂–Ω–æ –ª–∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å —Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä?

__–î–∞! ‚úÖ__ –≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è __vocabulary extension__ –∏–ª–∏ __—Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä fine-tuning__

### –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç?

–î–æ–±–∞–≤–∏—Ç—å __–Ω–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã__ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–ª–æ–≤–∞—Ä—å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, GPT, BERT)

### –ü—Ä–∏–º–µ—Ä:

```python
# –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä GPT-2
tokenizer = GPT2Tokenizer.from_pretrained("gpt2")
print(len(tokenizer))  # 50,257 —Ç–æ–∫–µ–Ω–æ–≤

# –î–æ–±–∞–≤–ª—è–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –¥–æ–º–µ–Ω–∞ —Ç–æ–∫–µ–Ω—ã
new_tokens = ["COVID-19", "mRNA", "–∞–Ω—Ç–∏—Ç–µ–ª–∞", "[MASK]"]
tokenizer.add_tokens(new_tokens)

print(len(tokenizer))  # 50,261 —Ç–æ–∫–µ–Ω (–¥–æ–±–∞–≤–∏–ª–∏ 4)

# –û–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å –Ω–∞ –≤–∞—à–µ–º –∫–æ—Ä–ø—É—Å–µ
# –ù–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã –ø–æ–ª—É—á–∞—Ç –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
trainer.train(model, dataset)
```

---

## üìå –í –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö —Å—Ç–æ–∏—Ç —Ä–∞—Å—à–∏—Ä—è—Ç—å —Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä?

### 1. __–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è__ ‚≠ê‚≠ê‚≠ê

__–ü—Ä–æ–±–ª–µ–º–∞:__

```javascript
–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Ç–µ–∫—Å—Ç: "–∞–∑–∏—Ç—Ä–æ–º–∏—Ü–∏–Ω"

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä:
["–∞–∑–∏—Ç", "—Ä–æ–º", "–∏—Ü", "–∏–Ω"]  ‚Üê 4 —Ç–æ–∫–µ–Ω–∞, —Ç–µ—Ä—è–µ—Ç—Å—è —Å–º—ã—Å–ª
```

__–†–µ—à–µ–Ω–∏–µ:__

```python
tokenizer.add_tokens(["–∞–∑–∏—Ç—Ä–æ–º–∏—Ü–∏–Ω"])

–¢–µ–ø–µ—Ä—å:
["–∞–∑–∏—Ç—Ä–æ–º–∏—Ü–∏–Ω"]  ‚Üê 1 —Ç–æ–∫–µ–Ω, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–µ–º–∞–Ω—Ç–∏–∫—É
```

__–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:__

- ‚úÖ –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã (–Ω–∞–∑–≤–∞–Ω–∏—è –ª–µ–∫–∞—Ä—Å—Ç–≤, –±–æ–ª–µ–∑–Ω–µ–π)
- ‚úÖ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã)
- ‚úÖ –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–∞–∑–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)
- ‚úÖ –•–∏–º–∏—è/–±–∏–æ–ª–æ–≥–∏—è (—Ñ–æ—Ä–º—É–ª—ã, –Ω–∞–∑–≤–∞–Ω–∏—è –≤–µ—â–µ—Å—Ç–≤)

---

### 2. __–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∑–∞–¥–∞—á__ ‚≠ê‚≠ê‚≠ê

__–ü—Ä–∏–º–µ—Ä—ã:__

```python
# –î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
tokenizer.add_special_tokens({"cls_token": "[CLS]"})

# –î–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —è–∑—ã–∫–æ–≤–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è
tokenizer.add_special_tokens({"mask_token": "[MASK]"})

# –î–ª—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π
tokenizer.add_special_tokens({"sep_token": "[SEP]"})

# –î–ª—è –¥–∏–∞–ª–æ–≥–æ–≤
tokenizer.add_tokens(["[USER]", "[BOT]", "[SYSTEM]"])
```

__–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:__

```javascript
–î–∏–∞–ª–æ–≥:
"[USER] –ü—Ä–∏–≤–µ—Ç! [BOT] –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?"
```

# –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –º–∞—Ç—Ä–∏—Ü–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ transformers? –ò –∫–∞–∫ –µ—ë –æ–±—É—á–∞—Ç—å —Å –Ω—É–ª—è?

# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ - –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –º–∞—Ç—Ä–∏—Ü–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ transformers? 

# –ß–µ–º –æ–±—ã—á–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö?

# –ù–∞ —á—Ç–æ –≤–ª–∏—è–µ—Ç —Ä–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è –≤ transformers?

# –ß—Ç–æ —Ç–∞–∫–æ–µ self-attention –≤ transformers? 

# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ - –ß—Ç–æ —Ç–∞–∫–æ–µ self-attention –≤ transformers? 

# –ï—â—ë –±–æ–ª—å—à–µ –≤–æ–ø—Ä–æ—Å–æ–≤ —Å —Å–æ–±–µ—Å–æ–≤ —Ç—É—Ç - —Ç–µ–ª–µ–≥—Ä–∞–º –∫–∞–Ω–∞–ª

# –ö–∞–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É self-attention? –ö–∞–∫ –æ–Ω —É—Å—Ç—Ä–æ–µ–Ω –≤–Ω—É—Ç—Ä–∏?

# –ü–æ–¥—Ä–æ–±–Ω–µ–π—à–µ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ self-attention

# –ù–∞–ø–∏—Å–∞–Ω–∏–µ self-attention —Å –Ω—É–ª—è –Ω–∞ torch
